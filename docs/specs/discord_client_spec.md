# Discord Botクライアント仕様書

## 📌 このドキュメントについて

このドキュメントは、**Discord（ディスコード）のボイスチャンネルに誰がいるかを調べるプログラム**の設計書です。
技術的な知識がない方でも理解できるように、できるだけ分かりやすく説明します。

---

## 1. 🎯 何をするプログラム？

### このプログラムの役割
想像してみてください。あなたがDiscordで友達と通話している時、**「今誰が通話に参加しているか」を自動で記録してくれるロボット**のようなものです。

### 具体的にできること
- ✅ 指定したボイスチャンネル（通話部屋）を監視
- ✅ そこに誰がいるかを自動でチェック
- ✅ ユーザーの名前とIDを記録
- ✅ この情報を他のシステムに渡す

### 使用例
たとえば、ゲーミングコミュニティで「今日の夜、誰がボイスチャンネルに参加したか」を自動で記録したい時に使います。

---

## 2. 🔧 どうやって動く？

### 動作の流れ（料理のレシピのように）

1. **準備** 🍳
   - Discordから「Bot（ボット）」という特別な権限をもらう
   - 監視したいボイスチャンネルを指定する

2. **接続** 🔌
   - BotがDiscordサーバーにログインする
   - まるで人間がDiscordアプリを開くような感じ

3. **情報収集** 📝
   - 指定されたボイスチャンネルを見に行く
   - そこにいる人の情報をメモする

4. **完了** ✅
   - 必要な情報を集めたら接続を切る
   - 集めた情報を整理して保存

---

## 3. 📊 どんな情報を集める？

### 集める情報の例

| 項目 | 説明 | 例 |
|------|------|-----|
| **サーバーID** | Discordサーバーの識別番号 | 123456789012345678 |
| **ユーザーID** | 各ユーザーの識別番号 | 111111111111111111 |
| **ユーザー名** | 表示される名前 | 田中太郎#1234 |

### プライバシーについて 🔒
- 必要最小限の情報のみ取得
- パスワードなどの個人情報は**一切取得しません**
- Discordの利用規約に従って動作

---

## 4. 🚀 使い始めるために必要なもの

### 事前準備チェックリスト

#### 1. Discord Botの作成
- [ ] Discord Developer Portalでアプリケーションを作成
- [ ] Botトークン（パスワードのようなもの）を取得
- [ ] 必要な権限を設定

#### 2. 必要な権限
以下の権限をBotに与える必要があります：
- **サーバーメンバーを見る権限** - メンバーリストを確認するため
- **ボイス状態を見る権限** - 誰がVCにいるか確認するため
- **チャンネルを見る権限** - VCの存在を確認するため

#### 3. 環境設定
```
DISCORD_BOT_TOKEN=あなたのBotトークン
ALLOWED_VOICE_CHANNEL_IDS=監視したいVCのID（カンマ区切り）
```

---

## 5. ⚠️ 注意事項とトラブルシューティング

### よくある問題と解決方法

#### 問題1：Botが動かない
**原因と対策：**
- トークンが間違っている → 正しいトークンを確認
- 権限が不足している → Bot権限を再確認
- インターネット接続の問題 → 接続を確認

#### 問題2：メンバーが表示されない
**原因と対策：**
- VCのIDが間違っている → 正しいIDを設定
- Botがサーバーに招待されていない → Botを招待する
- プライバシー設定の問題 → サーバー設定を確認

### エラーメッセージの意味

| エラー | 意味 | 対処法 |
|--------|------|--------|
| "Connection failed" | 接続に失敗しました | インターネット接続とトークンを確認 |
| "Permission denied" | 権限がありません | Bot権限を再設定 |
| "Channel not found" | チャンネルが見つかりません | チャンネルIDを確認 |

---

## 6. 🛡️ セキュリティについて

### 安全性を保つための仕組み

1. **トークンの保護** 🔐
   - Botトークンは「パスワード」のようなもの
   - 環境変数（安全な場所）に保存
   - 絶対に他人に教えない

2. **データの取り扱い** 📂
   - 最小限の情報のみ取得
   - 個人を特定できる情報は慎重に扱う
   - ログファイルには機密情報を記録しない

3. **アクセス制限** 🚪
   - 指定されたVCのみ監視
   - 不要なチャンネルにはアクセスしない

---

## 7. 📈 パフォーマンス（処理速度）について

### 処理時間の目安

| サーバー規模 | メンバー数 | 処理時間 |
|--------------|------------|----------|
| 小規模 | 〜100人 | 1秒以下 |
| 中規模 | 100〜500人 | 1〜3秒 |
| 大規模 | 500人以上 | 3〜10秒 |

### 制限事項
- **API制限**：Discordには1秒間にできるリクエスト数に制限があります
- **同時処理**：複数のVCを同時に監視する場合は順番に処理します

---

## 8. 🔄 メンテナンスとアップデート

### 定期的な確認事項

#### 毎月確認すること
- [ ] Botトークンの有効性
- [ ] Discord.pyライブラリの更新
- [ ] エラーログの確認

#### 問題が起きた時
1. エラーログを確認
2. Discord APIの変更を確認
3. 必要に応じてコードを更新

---

## 9. 💡 よくある質問（FAQ）

### Q1: Botは24時間動き続けますか？
**A:** いいえ、必要な時だけ起動して情報を取得し、すぐに停止します。

### Q2: 複数のサーバーで使えますか？
**A:** はい、Botを複数のサーバーに招待すれば使えます。

### Q3: 無料で使えますか？
**A:** Discord Bot自体は無料ですが、サーバー運用には費用がかかる場合があります。

### Q4: プライベートチャンネルも監視できますか？
**A:** Botに適切な権限があれば可能ですが、プライバシーに配慮が必要です。

---

## 10. 📚 もっと詳しく知りたい方へ

### 関連用語集

| 用語 | 説明 |
|------|------|
| **Discord** | ゲーマー向けから始まったチャットアプリ |
| **Bot（ボット）** | 自動で動作するプログラム |
| **VC（ボイスチャンネル）** | 音声通話ができる部屋 |
| **トークン** | Botを識別するための秘密の文字列 |
| **API** | プログラム同士が通信するための仕組み |
| **非同期処理** | 複数の処理を同時並行で行う技術 |

### 参考リンク
- [Discord Developer Portal](https://discord.com/developers/applications) - Botを作成する場所
- [Discord.py ドキュメント](https://discordpy.readthedocs.io/) - 使用しているライブラリの説明

---

## 11. 🚧 今後の改善予定

### 近い将来追加したい機能
- ⏰ リアルタイムで入退室を通知
- 📊 統計情報の自動生成
- 🔔 特定のユーザーが参加した時の通知

### 長期的な目標
- 複数VCの同時監視の効率化
- より詳細な活動ログの記録
- ウェブ管理画面の追加

---

## 📞 サポート

問題が発生した場合や質問がある場合は、以下の情報を準備してお問い合わせください：

1. **エラーメッセージ**の全文
2. **いつ**問題が発生したか
3. **何をしようとした時**に問題が起きたか
4. **Discord Botの設定**内容

この仕様書は定期的に更新されます。最新版は常にこのファイルを参照してください。

---

*最終更新日: 2025年1月*